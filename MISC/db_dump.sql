CREATE TABLE forums (
 id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
 name VARCHAR(255) NOT NULL,
 description TEXT NOT NULL
) ENGINE InnoDB;

CREATE TABLE users (
 id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
 name VARCHAR(255) NOT NULL UNIQUE,
 password VARCHAR(255),
 email VARCHAR(255) NOT NULL,
 type SMALLINT UNSIGNED NOT NULL CHECK (type > 0 AND type < 4),
 avatar VARCHAR(255)
) ENGINE InnoDB;

CREATE TABLE moderators_rights (
 user_id BIGINT UNSIGNED REFERENCES users (id) ON DELETE CASCADE,
 forum_id BIGINT UNSIGNED REFERENCES forums (id) ON DELETE CASCADE,
 UNIQUE(user_id, forum_id)
) ENGINE InnoDB;

CREATE TABLE topics (
 id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
 forum_id BIGINT UNSIGNED REFERENCES forums (id) ON DELETE CASCADE,
 poster_id BIGINT UNSIGNED REFERENCES users (id) ON DELETE CASCADE,
 title VARCHAR(255) NOT NULL,
 views_count BIGINT UNSIGNED DEFAULT 0
) ENGINE InnoDB;

CREATE TABLE posts (
 id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
 forum_id BIGINT UNSIGNED REFERENCES forums (id) ON DELETE CASCADE,
 topic_id BIGINT UNSIGNED REFERENCES topics (id) ON DELETE CASCADE,
 poster_id BIGINT UNSIGNED REFERENCES users (id) ON DELETE CASCADE,
 text TEXT NOT NULL,
 posted_time TIMESTAMP,
 last_updated_time TIMESTAMP
) ENGINE InnoDB;